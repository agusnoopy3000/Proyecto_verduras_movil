{
  "info": {
    "_postman_id": "huerto-hogar-api-2025",
    "name": "Huerto Hogar API",
    "description": "Colección de pruebas para la API de Huerto Hogar\n\nBase URL: http://52.2.172.54:8080/api/v1/",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://52.2.172.54:8080/api/v1"
    },
    {
      "key": "token",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "Autenticación",
      "item": [
        {
          "name": "Login Usuario Verificado",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.token) {",
                  "    pm.collectionVariables.set('token', jsonData.token);",
                  "    console.log('Token guardado exitosamente');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"prueba@test.cl\",\n  \"password\": \"Test123!\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            },
            "description": "Login con usuario VERIFICADO. El token se guarda automáticamente."
          }
        },
        {
          "name": "Login Cliente (crear primero)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.token) {",
                  "    pm.collectionVariables.set('token', jsonData.token);",
                  "    console.log('Token de Admin guardado');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@huertohogar.cl\",\n  \"password\": \"Admin123!\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login Vendedor",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.token) {",
                  "    pm.collectionVariables.set('token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"vendedor@huertohogar.cl\",\n  \"password\": \"Vendedor123!\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login Repartidor",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.token) {",
                  "    pm.collectionVariables.set('token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"repartidor@huertohogar.cl\",\n  \"password\": \"Repartidor123!\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Registro Nuevo Usuario",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"run\": \"12345678-9\",\n  \"nombre\": \"María\",\n  \"apellidos\": \"González López\",\n  \"email\": \"maria.test@ejemplo.cl\",\n  \"password\": \"MiPassword123!\",\n  \"direccion\": \"Av. Providencia 1234, Santiago\",\n  \"telefono\": \"+56912345678\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/register",
              "host": ["{{base_url}}"],
              "path": ["auth", "register"]
            },
            "description": "Registrar un nuevo usuario. Cambiar el email antes de ejecutar."
          }
        },
        {
          "name": "Firebase Sync (Auth Híbrida)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firebaseIdToken\": \"PEGAR_TOKEN_DE_FIREBASE_AQUI\",\n  \"run\": \"98765432-1\",\n  \"nombre\": \"Carlos\",\n  \"apellidos\": \"Rodríguez\",\n  \"direccion\": \"Las Condes 567\",\n  \"telefono\": \"+56987654321\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/firebase-sync",
              "host": ["{{base_url}}"],
              "path": ["auth", "firebase-sync"]
            },
            "description": "Sincronización híbrida con Firebase. El token se obtiene de Google Sign-In."
          }
        }
      ]
    },
    {
      "name": "Productos",
      "item": [
        {
          "name": "Listar Todos los Productos",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/products",
              "host": ["{{base_url}}"],
              "path": ["products"]
            }
          }
        },
        {
          "name": "Buscar Productos",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/products?q=tomate",
              "host": ["{{base_url}}"],
              "path": ["products"],
              "query": [
                {
                  "key": "q",
                  "value": "tomate"
                }
              ]
            },
            "description": "Buscar productos por nombre. Cambiar 'tomate' por el término deseado."
          }
        },
        {
          "name": "Obtener Producto por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/products/prod-001",
              "host": ["{{base_url}}"],
              "path": ["products", "prod-001"]
            },
            "description": "Cambiar 'prod-001' por el ID real del producto."
          }
        },
        {
          "name": "Obtener Producto por Código (QR)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/products/codigo/VER-001",
              "host": ["{{base_url}}"],
              "path": ["products", "codigo", "VER-001"]
            },
            "description": "Este endpoint se usa al escanear QR. Cambiar 'VER-001' por el código."
          }
        }
      ]
    },
    {
      "name": "Pedidos",
      "item": [
        {
          "name": "Crear Pedido",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"productoId\": \"prod-001\",\n      \"cantidad\": 2,\n      \"precioUnitario\": 2500\n    },\n    {\n      \"productoId\": \"prod-002\",\n      \"cantidad\": 1,\n      \"precioUnitario\": 1800\n    }\n  ],\n  \"direccionEnvio\": \"Av. Providencia 1234, Depto 56, Santiago\",\n  \"metodoPago\": \"TRANSFERENCIA\",\n  \"notas\": \"Tocar timbre 2 veces\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/orders",
              "host": ["{{base_url}}"],
              "path": ["orders"]
            }
          }
        },
        {
          "name": "Mis Pedidos",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/orders",
              "host": ["{{base_url}}"],
              "path": ["orders"]
            },
            "description": "Obtener todos los pedidos del usuario autenticado."
          }
        },
        {
          "name": "Obtener Pedido por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/orders/1",
              "host": ["{{base_url}}"],
              "path": ["orders", "1"]
            },
            "description": "Cambiar '1' por el ID real del pedido."
          }
        }
      ]
    },
    {
      "name": "Usuario",
      "item": [
        {
          "name": "Mi Perfil",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/users/me",
              "host": ["{{base_url}}"],
              "path": ["users", "me"]
            },
            "description": "Obtener los datos del usuario autenticado."
          }
        }
      ]
    }
  ]
}
